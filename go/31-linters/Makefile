.PHONY: help format vet lint lint-revive lint-staticcheck lint-golangci lint-fast lint-fix test build clean

help: ## Mostra esta mensagem de ajuda
	@echo "Comandos disponÃ­veis:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'

format: ## Formata cÃ³digo e organiza imports
	@echo "ğŸ“ Formatando cÃ³digo..."
	@if command -v goimports >/dev/null 2>&1; then \
		goimports -w .; \
		echo "âœ… CÃ³digo formatado!"; \
	else \
		echo "âŒ goimports nÃ£o encontrado. Instale com: go install golang.org/x/tools/cmd/goimports@latest"; \
		exit 1; \
	fi

vet: ## Executa go vet
	@echo "ğŸ” Executando go vet..."
	@go vet ./...
	@echo "âœ… go vet passou!"

lint-revive: ## Executa revive
	@echo "âœ¨ Executando revive..."
	@if command -v revive >/dev/null 2>&1; then \
		revive ./...; \
		echo "âœ… revive passou!"; \
	else \
		echo "âŒ revive nÃ£o encontrado. Instale com: go install github.com/mgechev/revive@latest"; \
		exit 1; \
	fi

lint-staticcheck: ## Executa staticcheck
	@echo "ğŸ” Executando staticcheck..."
	@if command -v staticcheck >/dev/null 2>&1; then \
		staticcheck ./...; \
		echo "âœ… staticcheck passou!"; \
	else \
		echo "âŒ staticcheck nÃ£o encontrado. Instale com: go install honnef.co/go/tools/cmd/staticcheck@latest"; \
		exit 1; \
	fi

lint-golangci: ## Executa golangci-lint (completo)
	@echo "ğŸš€ Executando golangci-lint..."
	@if command -v golangci-lint >/dev/null 2>&1; then \
		golangci-lint run; \
		echo "âœ… golangci-lint passou!"; \
	else \
		echo "âŒ golangci-lint nÃ£o encontrado. Instale com: brew install golangci-lint"; \
		exit 1; \
	fi

lint-fast: ## Executa golangci-lint (modo rÃ¡pido)
	@echo "âš¡ Executando golangci-lint (modo rÃ¡pido)..."
	@if command -v golangci-lint >/dev/null 2>&1; then \
		golangci-lint run --fast; \
		echo "âœ… golangci-lint (fast) passou!"; \
	else \
		echo "âŒ golangci-lint nÃ£o encontrado. Instale com: brew install golangci-lint"; \
		exit 1; \
	fi

lint-fix: ## Executa golangci-lint e tenta corrigir automaticamente
	@echo "ğŸ”§ Executando golangci-lint com correÃ§Ãµes automÃ¡ticas..."
	@if command -v golangci-lint >/dev/null 2>&1; then \
		golangci-lint run --fix; \
		echo "âœ… CorreÃ§Ãµes aplicadas!"; \
	else \
		echo "âŒ golangci-lint nÃ£o encontrado. Instale com: brew install golangci-lint"; \
		exit 1; \
	fi

lint: lint-revive lint-staticcheck ## Executa linters individuais (revive + staticcheck)

test: ## Executa testes
	@echo "ğŸ§ª Executando testes..."
	@go test -v ./...
	@echo "âœ… Testes concluÃ­dos!"

build: ## Compila o projeto
	@echo "ğŸ”¨ Compilando..."
	@go build -o app .
	@echo "âœ… CompilaÃ§Ã£o concluÃ­da!"

clean: ## Limpa arquivos gerados
	@echo "ğŸ§¹ Limpando..."
	@rm -f app
	@go clean
	@echo "âœ… Limpeza concluÃ­da!"

all: format vet lint-fast test ## Executa tudo (formato, vet, lint rÃ¡pido, testes)

ci: format vet lint-golangci test ## Executa tudo para CI/CD (formato, vet, lint completo, testes)



